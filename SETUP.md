# Инструкция по настройке

## Автоматическая установка (Windows)

Для автоматической установки всех необходимых компонентов используйте скрипт:

**Вариант 1 (рекомендуется):**
```powershell
PowerShell -ExecutionPolicy Bypass -File .\setup-windows.ps1
```

**Вариант 2:**
```cmd
setup-windows.bat
```

Скрипт автоматически:
- Проверит наличие Node.js, npm и PM2
- Установит PM2, если он отсутствует
- Запросит данные для создания .env файла
- Установит все зависимости проекта

## Ручная установка

### Шаг 1: Установка Node.js и npm

1. Скачайте и установите Node.js с [официального сайта](https://nodejs.org/) (рекомендуется LTS версия)
2. npm устанавливается автоматически вместе с Node.js
3. Проверьте установку:
   ```bash
   node --version
   npm --version
   ```

### Шаг 2: Установка PM2 (опционально, для продакшена)

```bash
npm install -g pm2
```

### Шаг 3: Установка зависимостей проекта

```bash
npm install
```

### Шаг 4: Создание файла .env

Создайте файл `.env` в корне проекта со следующим содержимым:

```
BOT_TOKEN=your_bot_token_here
ADMIN_PASSWORD=password123
DB_PATH=./database/bot.db
CAPTCHA_ENABLED=FALSE
```

**Важно:**
- `BOT_TOKEN` - можно указать несколько токенов через запятую для запуска нескольких ботов
- `DB_PATH` - путь к базе данных (можно оставить по умолчанию)
- `CAPTCHA_ENABLED` - включить капчу при команде /start (TRUE/FALSE)

### Как получить BOT_TOKEN:

1. Откройте Telegram и найдите бота [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания нового бота
4. Скопируйте полученный токен и вставьте его в файл `.env` вместо `your_bot_token_here`

## Шаг 3: Запуск бота

```bash
npm start
```

Для разработки с автоперезагрузкой:
```bash
npm run dev
```

## Первый запуск

При первом запуске бот автоматически:
- Создаст базу данных SQLite
- Инициализирует таблицы
- Загрузит тестовые данные (города, товары, методы оплаты)

## Использование

### Для пользователей:
1. Откройте бота в Telegram
2. Отправьте `/start`
3. Выберите город → товар → метод оплаты

### Для администраторов:
1. Отправьте команду `/apanel password123` (замените на ваш пароль из `.env`)
2. Используйте меню для управления данными

## Команды админ-панели

- `/addcity Название города` - добавить город
- `/addproduct cityId Название|Описание|Цена` - добавить товар
- `/addpayment Название|Сеть` - добавить метод оплаты (например: `/addpayment Bitcoin|BTC`)
- `/setaddress methodId Адрес` - изменить адрес для метода оплаты

## Примеры команд

```bash
# Добавить город
/addcity Москва

# Добавить товар (cityId можно узнать из админ-панели)
/addproduct 1 iPhone 15 Pro|Новейший смартфон Apple|89999

# Добавить метод оплаты
/addpayment Ethereum|ETH

# Изменить адрес (methodId можно узнать из админ-панели)
/setaddress 1 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb
```

